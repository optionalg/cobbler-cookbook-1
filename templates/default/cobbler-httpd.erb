# Generated by Chef.
# Local modifications will be overwritten.
# -- Trespassers W

# This configuration file allows cobbler data
# to be accessed over HTTP.

# TODO: 443 ?? certs ??

<VirtualHost *:80>
  AliasMatch ^/cblr(?!/svc/)(.*)?$ "<%= node[:cobbler][:docroot] %>$1"
  AliasMatch ^/cobbler_track(.*)?$ "<%= node[:cobbler][:docroot] %>$1"
  #AliasMatch ^/cobbler(.*)?$ "<%= node[:cobbler][:docroot] %>$1"
  Alias /cobbler <%= node[:cobbler][:docroot] %>
  Alias /cobbler_webui_content /var/www/cobbler_webui_content

  WSGIScriptAliasMatch ^/cblr/svc/([^/]*) <%= node[:cobbler][:docroot] %>/svc/services.py

  <Directory "<%= node[:cobbler][:docroot] %>">
    Options Indexes FollowSymLinks
    Order allow,deny
    Allow from all
  </Directory>

  ProxyRequests off

  <Proxy http://localhost:25151/>
  Order allow,deny
  Allow from all
</Proxy>

ProxyPass /cobbler_api http://localhost:25151/
ProxyPassReverse /cobbler_api http://localhost:25151/

BrowserMatch "MSIE" AuthDigestEnableQueryStringHack=On

CustomLog logs/access.log common

# the webui is now part of the "cobbler-web" package
# and is visited at http://.../cobbler_web not this URL.
# this is only a pointer to the new page.

<Directory "<%= node[:cobbler][:web][:root] %>">
  Options Indexes FollowSymLinks
  Order allow,deny
  Allow from all
</Directory>
</VirtualHost>
